<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PTMMA24 - Day 1 - Building a Performance Measure Case</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/Uni-Mannheim.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PTMMA24</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../exercises/day0.html" rel="" target="">
 <span class="menu-text">Day 0</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../exercises/day1.html" rel="" target="" aria-current="page">
 <span class="menu-text">Day 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../exercises/day2.html" rel="" target="">
 <span class="menu-text">Day 2</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/MatthiasUckert" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text">Github</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/matthias-uckert-579644a9/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text">LinkedIn</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="mailto:matthias.uckert@uni-mannheim.de" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text">Email</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cv/index.html" rel="" target=""><i class="bi bi-file-earmark" role="img">
</i> 
 <span class="menu-text">CV</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#loading-libraries" id="toc-loading-libraries" class="nav-link" data-scroll-target="#loading-libraries">Loading Libraries</a></li>
  <li><a href="#the-use-case" id="toc-the-use-case" class="nav-link" data-scroll-target="#the-use-case">The Use Case</a></li>
  <li><a href="#cost-allocation" id="toc-cost-allocation" class="nav-link" data-scroll-target="#cost-allocation">Cost Allocation</a>
  <ul class="collapse">
  <li><a href="#task-1-allocate-indirect-cost" id="toc-task-1-allocate-indirect-cost" class="nav-link" data-scroll-target="#task-1-allocate-indirect-cost">Task 1: Allocate Indirect Cost</a>
  <ul class="collapse">
  <li><a href="#task-1a-material-cost-allocation-preparation" id="toc-task-1a-material-cost-allocation-preparation" class="nav-link" data-scroll-target="#task-1a-material-cost-allocation-preparation">Task 1A: Material Cost Allocation Preparation</a></li>
  <li><a href="#task-1b-write-a-general-cost-allocation-formula" id="toc-task-1b-write-a-general-cost-allocation-formula" class="nav-link" data-scroll-target="#task-1b-write-a-general-cost-allocation-formula">Task 1B: Write a general cost allocation formula</a></li>
  </ul></li>
  <li><a href="#task-2-summing-cost-vectors" id="toc-task-2-summing-cost-vectors" class="nav-link" data-scroll-target="#task-2-summing-cost-vectors">Task 2: Summing Cost Vectors</a>
  <ul class="collapse">
  <li><a href="#task-2a-cost-summation-formula" id="toc-task-2a-cost-summation-formula" class="nav-link" data-scroll-target="#task-2a-cost-summation-formula">Task 2A: Cost Summation Formula</a></li>
  </ul></li>
  <li><a href="#task-3-using-real-data-for-cost-allocation" id="toc-task-3-using-real-data-for-cost-allocation" class="nav-link" data-scroll-target="#task-3-using-real-data-for-cost-allocation">Task 3: Using Real Data for Cost Allocation</a>
  <ul class="collapse">
  <li><a href="#task-3a-writing-a-formula-to-read-product-cost" id="toc-task-3a-writing-a-formula-to-read-product-cost" class="nav-link" data-scroll-target="#task-3a-writing-a-formula-to-read-product-cost">Task 3A: Writing a formula to read product cost</a></li>
  <li><a href="#task-3b-writing-formulas-to-get-cost-allocation-list" id="toc-task-3b-writing-formulas-to-get-cost-allocation-list" class="nav-link" data-scroll-target="#task-3b-writing-formulas-to-get-cost-allocation-list">Task 3B: Writing formulas to get Cost Allocation List</a></li>
  <li><a href="#task-3c-display-cost-allocation-table" id="toc-task-3c-display-cost-allocation-table" class="nav-link" data-scroll-target="#task-3c-display-cost-allocation-table">Task 3C: Display Cost Allocation Table</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#contribution-margin" id="toc-contribution-margin" class="nav-link" data-scroll-target="#contribution-margin">Contribution Margin</a>
  <ul class="collapse">
  <li><a href="#task-4a-subtracting-cost-vectors-for-revenue-vectors" id="toc-task-4a-subtracting-cost-vectors-for-revenue-vectors" class="nav-link" data-scroll-target="#task-4a-subtracting-cost-vectors-for-revenue-vectors">Task 4A: Subtracting Cost Vectors for Revenue Vectors</a></li>
  <li><a href="#task-4b-writing-a-formula-to-read-product-revenues" id="toc-task-4b-writing-a-formula-to-read-product-revenues" class="nav-link" data-scroll-target="#task-4b-writing-a-formula-to-read-product-revenues">Task 4B: Writing a formula to read product revenues</a></li>
  <li><a href="#task-4c-writing-formulas-to-get-contribution-margin-list" id="toc-task-4c-writing-formulas-to-get-contribution-margin-list" class="nav-link" data-scroll-target="#task-4c-writing-formulas-to-get-contribution-margin-list">Task 4C: Writing formulas to get Contribution Margin List</a></li>
  <li><a href="#task-4d-display-contribution-margin-table" id="toc-task-4d-display-contribution-margin-table" class="nav-link" data-scroll-target="#task-4d-display-contribution-margin-table">Task 4D: Display Contribution Margin Table</a></li>
  </ul></li>
  <li><a href="#monte-carlo-analysis" id="toc-monte-carlo-analysis" class="nav-link" data-scroll-target="#monte-carlo-analysis">Monte Carlo Analysis</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Day 1 - Building a Performance Measure Case</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Today’s complex business environment demands tools that offer both versatility and precision. In this session, we’ll explore three vital financial tasks using the R programming environment:</p>
<ol type="1">
<li><p><strong>Cost Allocation:</strong> Get a granular understanding of how costs disperse across products, emphasizing the allocation of indirect costs.</p></li>
<li><p><strong>Contribution Margin Analysis:</strong> Examine the profitability of individual products, distinguishing which products significantly impact the bottom line.</p></li>
<li><p><strong>Monte-Carlo Analysis:</strong> Navigate business uncertainties with this statistical technique, utilizing random sampling to achieve numerical results for multifaceted problems.</p></li>
</ol>
<p>But why opt for R over mainstream tools like Excel?</p>
<p><strong>The Case for R:</strong></p>
<ul>
<li><p><strong>Reproducibility:</strong> With R scripts, analyses can be reproduced and validated effortlessly. This is invaluable for audits or simply revisiting your work months or years later.</p></li>
<li><p><strong>Handling Large Data sets:</strong> R is equipped to manage extensive datasets, something Excel struggles with beyond a point.</p></li>
<li><p><strong>Flexibility:</strong> R’s vast array of packages and its ability to integrate with other languages and tools make it highly adaptable.</p></li>
<li><p><strong>Advanced Statistical Analysis:</strong> While Excel offers basic statistical tools, R provides a comprehensive suite for sophisticated analyses.</p></li>
<li><p><strong>Cost-Effective:</strong> Being open-source, R is freely available, ensuring businesses don’t incur additional software costs.</p></li>
</ul>
<p>By the session’s end, you’ll appreciate not just the theoretical aspects of these techniques but also the practical advantages of implementing them in an open-source environment like R.</p>
<p>Let’s get started!</p>
</section>
<section id="loading-libraries" class="level1">
<h1>Loading Libraries</h1>
<p>In this session, we’ll be leveraging various R libraries, each catering to specific tasks and functionalities. Here’s a breakdown of the libraries and their primary uses:</p>
<p><strong>Data Manipulation and Visualization</strong></p>
<ul>
<li><p><strong><code>tidyverse</code></strong>: A collection of packages tailored for data science.</p>
<ul>
<li>Includes <strong><code>dplyr</code></strong> for data manipulation, <strong><code>ggplot2</code></strong> for data visualization, <strong><code>readr</code></strong> for reading data, among others.</li>
</ul></li>
<li><p><strong><code>janitor</code></strong>: Useful for cleaning data and performing some basic data wrangling tasks.</p></li>
</ul>
<p><strong>Data I/O</strong></p>
<ul>
<li><strong><code>openxlsx</code></strong>: Specifically designed for reading from and writing to Excel sheets.</li>
</ul>
<p><strong>Numeric and Statistical Functions</strong></p>
<ul>
<li><p><strong><code>scales</code></strong>: Aids in formatting numbers, especially for data visualization purposes.</p></li>
<li><p><strong><code>furrr</code></strong>: An offshoot of the <strong><code>purrr</code></strong> package, <strong><code>furrr</code></strong> makes it easy to apply functions in parallel.</p></li>
</ul>
<p><strong>Themes and Visualization Enhancements</strong></p>
<ul>
<li><strong><code>ggthemes</code></strong>: Provides additional themes and scales for <strong><code>ggplot2</code></strong>, enhancing the aesthetics and readability of plots.</li>
</ul>
<p><strong>Miscellaneous</strong></p>
<ul>
<li><strong><code>tictoc</code></strong>: Helps in measuring the time taken for code execution, useful for performance tuning.</li>
</ul>
<p><strong>Custom Functions</strong></p>
<ul>
<li><strong><code>source("additional_functions.R")</code></strong>: Loads user-defined functions from an external R script.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(furrr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fst)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"additional_functions.R"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>sc <span class="ot">&lt;-</span> scales<span class="sc">::</span>comma</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-use-case" class="level1 page-columns page-full">
<h1>The Use Case</h1>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="..\img/CostOverview.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption margin-caption">Cost Overview</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="..\img/CostAllocation.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption margin-caption">Cost Allocation</figcaption>
</figure>
</div>
</section>
<section id="cost-allocation" class="level1">
<h1>Cost Allocation</h1>
<section id="task-1-allocate-indirect-cost" class="level2">
<h2 class="anchored" data-anchor-id="task-1-allocate-indirect-cost">Task 1: Allocate Indirect Cost</h2>
<p>We know that we have to allocate indirect costs onto the individual product. Let’s tale Material Cost as an example:</p>
<ul>
<li><p>Direct Cost Elite (DC<sub>1</sub>): 30,000 €</p></li>
<li><p>Direct Cost Premium (DC<sub>2</sub>): 70,000 €</p></li>
<li><p>Indirect Cost (IC): 40,000</p></li>
</ul>
<p>The general Formula for allocating indirect Cost is:</p>
<p><span class="math display">\[
IC_{c,i} = IC_{c}*\frac{DC_{c,i}}{\sum_{i} DC_i}
\]</span></p>
<section id="task-1a-material-cost-allocation-preparation" class="level3">
<h3 class="anchored" data-anchor-id="task-1a-material-cost-allocation-preparation">Task 1A: Material Cost Allocation Preparation</h3>
<p>Use the given data to calculate the cost allocation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mat_dic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Elite"</span> <span class="ot">=</span> <span class="dv">30000</span>, <span class="st">"Premium"</span> <span class="ot">=</span> <span class="dv">70000</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mat_inc <span class="ot">&lt;-</span> <span class="dv">40000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>ToDo: Calculate the correct value for mat_ac</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mat_alc <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CALCULATION HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Elite Premium 
  12000   28000 </code></pre>
</div>
</div>
<p>Check Your Result</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_named_vector</span>(mat_alc, <span class="fu">c</span>(<span class="st">"Elite"</span> <span class="ot">=</span> <span class="dv">12000</span>, <span class="st">"Premium"</span> <span class="ot">=</span> <span class="dv">28000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Success: Correct Values and Names</code></pre>
</div>
</div>
</section>
<section id="task-1b-write-a-general-cost-allocation-formula" class="level3">
<h3 class="anchored" data-anchor-id="task-1b-write-a-general-cost-allocation-formula">Task 1B: Write a general cost allocation formula</h3>
<p>Ensure the function only accepts named numeric vectors.</p>
<p>Name conventions: <code>.m_dic</code> for the direct cost vector, and <code>.s_inc</code> for the indirect cost (<strong>m_</strong> stands for multiple values and <strong>s_</strong> stands for single values).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>allocate_indirect_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(.m_dic, .s_inc) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mat_alc <span class="ot">&lt;-</span> <span class="fu">allocate_indirect_cost</span>(mat_dic, mat_inc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check Your Result</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_named_vector</span>(mat_alc, <span class="fu">c</span>(<span class="st">"Elite"</span> <span class="ot">=</span> <span class="dv">12000</span>, <span class="st">"Premium"</span> <span class="ot">=</span> <span class="dv">28000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Success: Correct Values and Names</code></pre>
</div>
</div>
</section>
</section>
<section id="task-2-summing-cost-vectors" class="level2">
<h2 class="anchored" data-anchor-id="task-2-summing-cost-vectors">Task 2: Summing Cost Vectors</h2>
<p>The goal here is to devise a formula that can take multiple named numeric vectors as its input and return a new vector whose elements are the piece-wise sum of the elements in the input vectors. This formula will allow you to combine, for example, direct costs and allocated indirect costs to derive the total costs.</p>
<section id="task-2a-cost-summation-formula" class="level3">
<h3 class="anchored" data-anchor-id="task-2a-cost-summation-formula">Task 2A: Cost Summation Formula</h3>
<p>You aim to create a function, <strong><code>sum_cost</code></strong>, that can receive any number of named numeric vectors and return their piece-wise sum.</p>
<p>The two common methods in R to handle an arbitrary number of function inputs are:</p>
<ol type="1">
<li><p><strong>Using a list</strong>: Each vector is considered an item in the list. This method is more structured but requires each vector to be manually added to the list.</p></li>
<li><p><strong>Using the <code>...</code> operator</strong>: This is a placeholder for any number of arguments that can be passed to a function. It provides flexibility because you don’t have to specify in advance how many arguments you’re going to use. Later, inside the function, you can convert <strong><code>...</code></strong> to a list using the <strong><code>list(...)</code></strong> function, allowing you to manipulate the arguments as a single list object.</p></li>
</ol>
<p>Given these methods, here’s how you can create the <strong><code>sum_cost</code></strong> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sum_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mat_tot <span class="ot">&lt;-</span> <span class="fu">sum_cost</span>(mat_dic, mat_inc )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check Your Result</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_named_vector</span>(mat_tot, <span class="fu">c</span>(<span class="st">"Elite"</span> <span class="ot">=</span> <span class="dv">70000</span>, <span class="st">"Premium"</span> <span class="ot">=</span> <span class="dv">110000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Success: Correct Values and Names</code></pre>
</div>
</div>
</section>
</section>
<section id="task-3-using-real-data-for-cost-allocation" class="level2">
<h2 class="anchored" data-anchor-id="task-3-using-real-data-for-cost-allocation">Task 3: Using Real Data for Cost Allocation</h2>
<p>To understand and compute the cost allocation using the lecture data, we’ll extract it from an Excel sheet and perform specific operations based on the data’s structure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tab_cost <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">as_tibble</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  openxlsx<span class="sc">::</span><span class="fu">read.xlsx</span>(<span class="st">"../Business Case.xlsx"</span>, <span class="st">"Cost1"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>tab_cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 x 6
  type     product department    amount distr   range_std
  &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
1 Direct   Elite   Material       30000 normal       5000
2 Direct   Premium Material       70000 normal       7500
3 Indirect &lt;NA&gt;    Material       40000 uniform      5000
4 Direct   Elite   Manufacturing  40000 normal       2500
5 Direct   Premium Manufacturing  50000 normal       1500
6 Indirect &lt;NA&gt;    Manufacturing 135000 uniform     25000
7 Indirect &lt;NA&gt;    Admin          73000 uniform      7500
8 Indirect &lt;NA&gt;    Marketing      36500 uniform      3750
9 Company  &lt;NA&gt;    &lt;NA&gt;           30000 uniform     22500</code></pre>
</div>
</div>
<p>Here, we use the <strong><code>openxlsx</code></strong> package to read the specific sheet “Cost1” from the Excel file. This data is then converted into a <strong><code>tibble</code></strong> (a modern form of R’s data frame) for easier manipulation. The <strong><code>clean_names()</code></strong> function from the <strong><code>janitor</code></strong> package is used to ensure our column names are consistent and easy to work with.</p>
<section id="task-3a-writing-a-formula-to-read-product-cost" class="level3">
<h3 class="anchored" data-anchor-id="task-3a-writing-a-formula-to-read-product-cost">Task 3A: Writing a formula to read product cost</h3>
<p><strong>Objective</strong>: For this task, your goal is to write a function named <strong><code>filter_cost_input</code></strong> that filters the data for a specific cost type (e.g., Direct or Indirect) and a specific department (e.g., Material, Manufacturing). This function should return a named numeric vector where names are products, and values are the associated costs.</p>
<p><strong>YOUR FUNCTION</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>filter_cost_input <span class="ot">&lt;-</span> <span class="cf">function</span>(.tab, .type, .dep) {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Instructions</strong>:</p>
<ol type="1">
<li><p>Use the <strong><code>filter()</code></strong> function from the <strong><code>dplyr</code></strong> package to filter the table based on the given cost type and department.</p></li>
<li><p>After filtering, arrange the results based on the product name. This will ensure consistency in later steps.</p></li>
<li><p>Now, you’ll need to generate a named vector from the filtered results. This can be achieved using the <strong><code>mutate()</code></strong> function to set the names of the <strong><code>amount</code></strong> column to be the respective product names.</p></li>
<li><p>Finally, extract just the named <strong><code>amount</code></strong> vector using the <strong><code>pull()</code></strong> function.</p></li>
</ol>
<div class="cell">

</div>
<p>Check Your Result</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mat_dic <span class="ot">&lt;-</span> <span class="fu">filter_cost_input</span>(tab_cost, <span class="st">"Direct"</span>, <span class="st">"Material"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>mat_dic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Elite Premium 
  30000   70000 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_named_vector</span>(mat_dic, <span class="fu">c</span>(<span class="st">"Elite"</span> <span class="ot">=</span> <span class="dv">30000</span>, <span class="st">"Premium"</span> <span class="ot">=</span> <span class="dv">70000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Success: Correct Values and Names</code></pre>
</div>
</div>
</section>
<section id="task-3b-writing-formulas-to-get-cost-allocation-list" class="level3">
<h3 class="anchored" data-anchor-id="task-3b-writing-formulas-to-get-cost-allocation-list">Task 3B: Writing formulas to get Cost Allocation List</h3>
<p><strong>Objective</strong>: The aim of this exercise is to calculate different types of costs, both direct and indirect, and allocate them properly across products.</p>
<p><strong>Step-by-Step Guide:</strong></p>
<ol type="1">
<li><p><strong>Understand the Structure</strong>: The <strong><code>get_cost_allocations</code></strong> function will compute various costs and store them in a list. This list will help organize and categorize costs according to their type and department.</p></li>
<li><p><strong>Material Costs</strong>:</p>
<ul>
<li><p><strong>Direct Material Cost (<code>mat_dic</code>)</strong>: This is already computed for you using the <strong><code>filter_cost_input</code></strong> function. It represents the costs directly linked to materials for each product.</p></li>
<li><p><strong>Indirect Material Cost (<code>mat_inc</code>)</strong>: These costs are associated with materials but can’t be linked to a specific product. Instead, they’re spread out across all products.</p></li>
<li><p><strong>Allocated Material Cost (<code>mat_alc</code>)</strong>: Here, you need to allocate the indirect material cost across all products based on some allocation rule (like proportion of direct costs or units produced). Use the <strong><code>allocate_indirect_cost</code></strong> function with <strong><code>mat_dic</code></strong> and <strong><code>mat_inc</code></strong> as arguments.</p></li>
<li><p><strong>Total Material Cost (<code>mat_tot</code>)</strong>: This is the sum of direct material cost and allocated indirect material cost. Use the <strong><code>sum_cost</code></strong> function.</p></li>
</ul></li>
<li><p><strong>Manufacturing Costs</strong>:</p>
<ul>
<li><p><strong>Direct Manufacturing Cost (<code>man_dic</code>)</strong> and <strong>Indirect Manufacturing Cost (<code>man_inc</code>)</strong>: These are computed in a manner similar to material costs.</p></li>
<li><p><strong>Allocated Manufacturing Cost (<code>man_alc</code>)</strong>: Allocate the indirect manufacturing cost across products. Consider factors like machine hours or labor hours if relevant.</p></li>
<li><p><strong>Total Manufacturing Cost (<code>man_tot</code>)</strong>: Sum up the direct and allocated indirect manufacturing costs.</p></li>
</ul></li>
<li><p><strong>Administrative Costs</strong>:</p>
<ul>
<li><p><strong>Indirect Admin Cost (<code>adm_inc</code>)</strong>: As administrative costs are often indirect, allocate these across products based on a suitable allocation base (e.g., total costs or sales).</p></li>
<li><p><strong>Allocated Admin Cost (<code>adm_alc</code>)</strong>: Spread the indirect admin cost using an appropriate rule.</p></li>
</ul></li>
<li><p><strong>Marketing Costs</strong>:</p>
<ul>
<li><p><strong>Indirect Marketing Cost (<code>mar_inc</code>)</strong>: These are the costs associated with marketing activities that can’t be directly linked to a product.</p></li>
<li><p><strong>Allocated Marketing Cost (<code>mar_alc</code>)</strong>: Distribute the marketing costs among products.</p></li>
</ul></li>
<li><p><strong>Total Product Cost (<code>prd_tot</code>)</strong>: This is a summation of all costs associated with a product - material, manufacturing, administrative, and marketing. Ensure all costs are considered, both direct and allocated indirect.</p></li>
</ol>
<p>Use the Functions <code>allocate_indirect_cost()</code> and <code>sum_cost()</code> to complete the <code>get_cost_allocations()</code> functions</p>
<p><strong>YOUR FUNCTION</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>get_cost_allocations <span class="ot">&lt;-</span> <span class="cf">function</span>(.tab_cost) {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create an empty list to store values</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  lst_ <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Material Cost</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"mat_dic"</span>]] <span class="ot">&lt;-</span> <span class="fu">filter_cost_input</span>(.tab_cost, <span class="st">"Direct"</span>, <span class="st">"Material"</span>)   <span class="co"># Direct Material Cost</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"mat_inc"</span>]] <span class="ot">&lt;-</span> <span class="fu">filter_cost_input</span>(.tab_cost, <span class="st">"Indirect"</span>, <span class="st">"Material"</span>) <span class="co"># Indirect Material Cost</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"mat_alc"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE                                # Allocated Material Cost</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"mat_tot"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE                                # Total Material Cost</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Manufacturing Cost</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"man_dic"</span>]] <span class="ot">&lt;-</span> <span class="fu">filter_cost_input</span>(.tab_cost, <span class="st">"Direct"</span>, <span class="st">"Manufacturing"</span>)   <span class="co"># Direct Manufacturing Cost</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"man_inc"</span>]] <span class="ot">&lt;-</span> <span class="fu">filter_cost_input</span>(.tab_cost, <span class="st">"Indirect"</span>, <span class="st">"Manufacturing"</span>) <span class="co"># Indirect Manufacturing Cost</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"man_alc"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE                                     # Allocated Manufacturing Cost</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"man_tot"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE                                     # Total Manufacturing Cost</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Administrative Cost</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"adm_inc"</span>]] <span class="ot">&lt;-</span> <span class="fu">filter_cost_input</span>(.tab_cost, <span class="st">"Indirect"</span>, <span class="st">"Admin"</span>) <span class="co"># Indirect Admin Cost</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"adm_alc"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE                             # Allocated Admin Cost</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Marketing Cost</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"mar_inc"</span>]] <span class="ot">&lt;-</span> <span class="fu">filter_cost_input</span>(.tab_cost, <span class="st">"Indirect"</span>, <span class="st">"Marketing"</span>) <span class="co"># Indirect Marketing Cost</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"mar_alc"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE                                 # Allocated Marketing Cost</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Total Product Cost</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  lst_[[<span class="st">"prd_tot"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lst_)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p><strong>Function Breakdown:</strong></p>
<ol type="1">
<li><p><strong>Function Name</strong>: <strong><code>get_cost_allocation_skeleton</code></strong></p>
<ul>
<li>This name suggests that we are fetching or creating a foundational structure for our cost allocations.</li>
</ul></li>
<li><p><strong>The <code>tibble::tribble</code> Function</strong>:</p>
<ul>
<li><p>This function is from the <strong><code>tibble</code></strong> package and helps in creating a small table (or tibble) in a readable form.</p></li>
<li><p>The <strong><code>~sign</code></strong> and <strong><code>~var</code></strong> are column names in this table. Each subsequent line in the function provides a row of data for these columns.</p></li>
</ul></li>
</ol>
<p><strong>Usage:</strong></p>
<p>When you call the function, it returns the described tibble structure. This “skeleton” serves as a roadmap for allocating and tallying up various costs. As you proceed with the exercise, you will populate this table with actual monetary values corresponding to each cost type. This visual representation helps in comprehending the flow and accumulation of different cost components.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>get_cost_allocation_skeleton <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>sign, <span class="sc">~</span>var,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">" "</span>, <span class="st">"Direct Material Costs"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"+"</span>, <span class="st">"Indirect Material Costs"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"="</span>, <span class="st">"Material Costs"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"+"</span>, <span class="st">"Direct Manufacturing Costs"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"+"</span>, <span class="st">"Indirect Manufacturing Costs"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"="</span>, <span class="st">"Manufacturing Costs"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"+"</span>, <span class="st">"Indirect Administration Costs"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"+"</span>, <span class="st">"Indirect Marketing Costs"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"="</span>, <span class="st">"Total Product Costs"</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_cost_allocation_skeleton</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 x 2
  sign  var                          
  &lt;chr&gt; &lt;chr&gt;                        
1 " "   Direct Material Costs        
2 "+"   Indirect Material Costs      
3 "="   Material Costs               
4 "+"   Direct Manufacturing Costs   
5 "+"   Indirect Manufacturing Costs 
6 "="   Manufacturing Costs          
7 "+"   Indirect Administration Costs
8 "+"   Indirect Marketing Costs     
9 "="   Total Product Costs          </code></pre>
</div>
</div>
</section>
<section id="task-3c-display-cost-allocation-table" class="level3">
<h3 class="anchored" data-anchor-id="task-3c-display-cost-allocation-table">Task 3C: Display Cost Allocation Table</h3>
<p>In this task, your goal is to use the pre-defined functions <strong><code>get_cost_allocation_list()</code></strong> and <strong><code>get_cost_allocation_skeleton()</code></strong> to construct the final Cost Allocation Table.</p>
<p>The Cost Allocation Table is crucial because it breaks down both direct and indirect costs, allowing a company to understand its cost structure better. By the end of this task, you should be able to represent all these costs in a well-organized table.</p>
<p><strong>Instructions:</strong></p>
<ol type="1">
<li><p><strong>Understanding the Skeleton</strong>:</p>
<ul>
<li><p>Before jumping into building the entire table, let’s familiarize ourselves with the <strong><code>get_cost_allocation_skeleton()</code></strong> function. This function provides a structured, step-by-step representation of how costs are compiled. Each row of the output represents either an individual cost or a summation.</p></li>
<li><p>Try running the function by itself to see its output!</p></li>
</ul></li>
<li><p><strong>Fetching the Costs</strong>:</p>
<ul>
<li><p>The <strong><code>get_cost_allocation_list()</code></strong> function is designed to extract various types of costs from the dataset. It returns a list containing costs categorized by their type (direct, indirect) and nature (material, manufacturing, etc.).</p></li>
<li><p>For the purpose of this task, run the function with your dataset and examine its output. Familiarize yourself with the different types of costs it provides.</p></li>
</ul></li>
<li><p><strong>Building the Table</strong>:</p>
<ul>
<li><p>Your main challenge is to construct the Cost Allocation Table. This will involve integrating the structure provided by the skeleton with the actual cost data.</p></li>
<li><p>Think of how you can combine the structured format of the skeleton with the actual cost numbers. You’ll need to fetch each relevant cost from the list and place it in the correct position within the table.</p></li>
<li><p>Note: The skeleton uses signs like “+” and “=” to signify addition and summation. This can guide you on where and how to place and calculate costs.</p></li>
</ul></li>
<li><p><strong>Steps to Consider for the Function</strong>:</p>
<ul>
<li><p>Start by fetching the costs using <strong><code>get_cost_allocation_list()</code></strong>.</p></li>
<li><p>Use the output of <strong><code>get_cost_allocation_skeleton()</code></strong> as your foundational table.</p></li>
<li><p>For each line in the skeleton, fetch the corresponding cost from your list and append it as a new column to the table.</p></li>
<li><p>Once you’ve placed all the individual costs, think about the rows that require summation (those with “=”). Calculate these using the appropriate rows.</p></li>
<li><p>Continue this process until you’ve constructed the entire table.</p></li>
<li><p>Add a Total Column to the Table that shows the total cost over all Products</p></li>
</ul></li>
<li><p><strong>Testing</strong>:</p>
<ul>
<li>Once you’ve written your function, test it with the given data. Your output should align with the structure of the skeleton and display all the relevant costs.</li>
</ul></li>
</ol>
<p><strong>Tips:</strong></p>
<ul>
<li><p>Remember, you’re not starting from scratch! You have a structured format and categorized data. It’s all about bringing them together in the right order.</p></li>
<li><p>The use of functions from packages like <strong><code>dplyr</code></strong> and <strong><code>purrr</code></strong> can significantly simplify data manipulation and transformation. If you’re familiar with these, consider how they can assist in your task.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>get_cost_allocation_table <span class="ot">&lt;-</span> <span class="cf">function</span>(.tab_cost) {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_cost_allocation_table</span>(<span class="at">.tab_cost =</span> tab_cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 x 5
  sign  var                            Total  Elite Premium
  &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 " "   Direct Material Costs         100000  30000   70000
2 "+"   Indirect Material Costs        40000  12000   28000
3 "="   Material Costs                140000  42000   98000
4 "+"   Direct Manufacturing Costs     90000  40000   50000
5 "+"   Indirect Manufacturing Costs  135000  60000   75000
6 "="   Manufacturing Costs           365000 142000  223000
7 "+"   Indirect Administration Costs  73000  28400   44600
8 "+"   Indirect Marketing Costs       36500  14200   22300
9 "="   Total Product Costs           474500 184600  289900</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(<span class="fu">get_cost_allocation_table</span>(tab_cost))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="fjvedwqjil" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fjvedwqjil table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fjvedwqjil thead, #fjvedwqjil tbody, #fjvedwqjil tfoot, #fjvedwqjil tr, #fjvedwqjil td, #fjvedwqjil th {
  border-style: none;
}

#fjvedwqjil p {
  margin: 0;
  padding: 0;
}

#fjvedwqjil .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fjvedwqjil .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fjvedwqjil .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fjvedwqjil .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fjvedwqjil .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fjvedwqjil .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fjvedwqjil .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fjvedwqjil .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fjvedwqjil .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fjvedwqjil .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fjvedwqjil .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fjvedwqjil .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fjvedwqjil .gt_spanner_row {
  border-bottom-style: hidden;
}

#fjvedwqjil .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fjvedwqjil .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fjvedwqjil .gt_from_md > :first-child {
  margin-top: 0;
}

#fjvedwqjil .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fjvedwqjil .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fjvedwqjil .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fjvedwqjil .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fjvedwqjil .gt_row_group_first td {
  border-top-width: 2px;
}

#fjvedwqjil .gt_row_group_first th {
  border-top-width: 2px;
}

#fjvedwqjil .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fjvedwqjil .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fjvedwqjil .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fjvedwqjil .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fjvedwqjil .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fjvedwqjil .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fjvedwqjil .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fjvedwqjil .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fjvedwqjil .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fjvedwqjil .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fjvedwqjil .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fjvedwqjil .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fjvedwqjil .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fjvedwqjil .gt_left {
  text-align: left;
}

#fjvedwqjil .gt_center {
  text-align: center;
}

#fjvedwqjil .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fjvedwqjil .gt_font_normal {
  font-weight: normal;
}

#fjvedwqjil .gt_font_bold {
  font-weight: bold;
}

#fjvedwqjil .gt_font_italic {
  font-style: italic;
}

#fjvedwqjil .gt_super {
  font-size: 65%;
}

#fjvedwqjil .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fjvedwqjil .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fjvedwqjil .gt_indent_1 {
  text-indent: 5px;
}

#fjvedwqjil .gt_indent_2 {
  text-indent: 10px;
}

#fjvedwqjil .gt_indent_3 {
  text-indent: 15px;
}

#fjvedwqjil .gt_indent_4 {
  text-indent: 20px;
}

#fjvedwqjil .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="sign">sign</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="var">var</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Total">Total</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Elite">Elite</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Premium">Premium</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sign" class="gt_row gt_left"> </td>
<td headers="var" class="gt_row gt_left">Direct Material Costs</td>
<td headers="Total" class="gt_row gt_right">100,000</td>
<td headers="Elite" class="gt_row gt_right">30,000</td>
<td headers="Premium" class="gt_row gt_right">70,000</td></tr>
    <tr><td headers="sign" class="gt_row gt_left">+</td>
<td headers="var" class="gt_row gt_left">Indirect Material Costs</td>
<td headers="Total" class="gt_row gt_right">40,000</td>
<td headers="Elite" class="gt_row gt_right">12,000</td>
<td headers="Premium" class="gt_row gt_right">28,000</td></tr>
    <tr><td headers="sign" class="gt_row gt_left" style="font-weight: bold;">=</td>
<td headers="var" class="gt_row gt_left" style="font-weight: bold;">Material Costs</td>
<td headers="Total" class="gt_row gt_right" style="font-weight: bold;">140,000</td>
<td headers="Elite" class="gt_row gt_right" style="font-weight: bold;">42,000</td>
<td headers="Premium" class="gt_row gt_right" style="font-weight: bold;">98,000</td></tr>
    <tr><td headers="sign" class="gt_row gt_left">+</td>
<td headers="var" class="gt_row gt_left">Direct Manufacturing Costs</td>
<td headers="Total" class="gt_row gt_right">90,000</td>
<td headers="Elite" class="gt_row gt_right">40,000</td>
<td headers="Premium" class="gt_row gt_right">50,000</td></tr>
    <tr><td headers="sign" class="gt_row gt_left">+</td>
<td headers="var" class="gt_row gt_left">Indirect Manufacturing Costs</td>
<td headers="Total" class="gt_row gt_right">135,000</td>
<td headers="Elite" class="gt_row gt_right">60,000</td>
<td headers="Premium" class="gt_row gt_right">75,000</td></tr>
    <tr><td headers="sign" class="gt_row gt_left" style="font-weight: bold;">=</td>
<td headers="var" class="gt_row gt_left" style="font-weight: bold;">Manufacturing Costs</td>
<td headers="Total" class="gt_row gt_right" style="font-weight: bold;">365,000</td>
<td headers="Elite" class="gt_row gt_right" style="font-weight: bold;">142,000</td>
<td headers="Premium" class="gt_row gt_right" style="font-weight: bold;">223,000</td></tr>
    <tr><td headers="sign" class="gt_row gt_left">+</td>
<td headers="var" class="gt_row gt_left">Indirect Administration Costs</td>
<td headers="Total" class="gt_row gt_right">73,000</td>
<td headers="Elite" class="gt_row gt_right">28,400</td>
<td headers="Premium" class="gt_row gt_right">44,600</td></tr>
    <tr><td headers="sign" class="gt_row gt_left">+</td>
<td headers="var" class="gt_row gt_left">Indirect Marketing Costs</td>
<td headers="Total" class="gt_row gt_right">36,500</td>
<td headers="Elite" class="gt_row gt_right">14,200</td>
<td headers="Premium" class="gt_row gt_right">22,300</td></tr>
    <tr><td headers="sign" class="gt_row gt_left" style="font-weight: bold;">=</td>
<td headers="var" class="gt_row gt_left" style="font-weight: bold;">Total Product Costs</td>
<td headers="Total" class="gt_row gt_right" style="font-weight: bold;">474,500</td>
<td headers="Elite" class="gt_row gt_right" style="font-weight: bold;">184,600</td>
<td headers="Premium" class="gt_row gt_right" style="font-weight: bold;">289,900</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="contribution-margin" class="level1">
<h1>Contribution Margin</h1>
<p>Having the cost allocation ready, we no focus on performance measures, namely the contribution margin. Looking at the Contribution margin table we see that we now need another function, namely where we have one positive input value (e.g.&nbsp;revenue) and subtract a cost element (e.g.&nbsp;Variable Cost)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>tab_revenue <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">as_tibble</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  openxlsx<span class="sc">::</span><span class="fu">read.xlsx</span>(<span class="st">"../Business Case.xlsx"</span>, <span class="st">"Revenue1"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>tab_revenue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 6
  product units price amount distr  range_std
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
1 Elite     500   350 175000 normal     25000
2 Premium   500   600 300000 normal     30000</code></pre>
</div>
</div>
<section id="task-4a-subtracting-cost-vectors-for-revenue-vectors" class="level2">
<h2 class="anchored" data-anchor-id="task-4a-subtracting-cost-vectors-for-revenue-vectors">Task 4A: Subtracting Cost Vectors for Revenue Vectors</h2>
<p>You aim to create a function, <strong><code>substract_cost</code></strong>, that can receive any number of named numeric vectors and subtract values from the first value.</p>
<p>The two common methods in R to handle an arbitrary number of function inputs are:</p>
<ol type="1">
<li><p><strong>Using a list</strong>: Each vector is considered an item in the list. This method is more structured but requires each vector to be manually added to the list.</p></li>
<li><p><strong>Using the <code>...</code> operator</strong>: This is a placeholder for any number of arguments that can be passed to a function. It provides flexibility because you don’t have to specify in advance how many arguments you’re going to use. Later, inside the function, you can convert <strong><code>...</code></strong> to a list using the <strong><code>list(...)</code></strong> function, allowing you to manipulate the arguments as a single list object.</p></li>
</ol>
<p>Given these methods, here’s how you can create the <strong><code>substract_cost</code></strong> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>subtract_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>Check Your Result</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>revenues <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Elite"</span> <span class="ot">=</span> <span class="dv">100000</span>, <span class="st">"Premium"</span> <span class="ot">=</span> <span class="dv">250000</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>var_cost <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Elite"</span> <span class="ot">=</span> <span class="dv">70000</span>, <span class="st">"Premium"</span> <span class="ot">=</span> <span class="dv">120000</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>cm1 <span class="ot">&lt;-</span> <span class="fu">subtract_cost</span>(revenues, var_cost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_named_vector</span>(cm1, <span class="fu">c</span>(<span class="st">"Elite"</span> <span class="ot">=</span> <span class="dv">30000</span>, <span class="st">"Premium"</span> <span class="ot">=</span> <span class="dv">130000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Success: Correct Values and Names</code></pre>
</div>
</div>
</section>
<section id="task-4b-writing-a-formula-to-read-product-revenues" class="level2">
<h2 class="anchored" data-anchor-id="task-4b-writing-a-formula-to-read-product-revenues">Task 4B: Writing a formula to read product revenues</h2>
<p><strong>Objective</strong>: For this task, your goal is to write a function named <strong><code>filter_revenue_input</code></strong> This function should return a named numeric vector where names are products, and values are the associated costs.</p>
<p><strong>YOUR FUNCTION</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>filter_revenue_input <span class="ot">&lt;-</span> <span class="cf">function</span>(.tab, .type, .dep) {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter_revenue_input</span>(tab_revenue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Elite Premium 
 175000  300000 </code></pre>
</div>
</div>
</section>
<section id="task-4c-writing-formulas-to-get-contribution-margin-list" class="level2">
<h2 class="anchored" data-anchor-id="task-4c-writing-formulas-to-get-contribution-margin-list">Task 4C: Writing formulas to get Contribution Margin List</h2>
<p>Remember Task 3B. Use the Functions <code>subtract_cost()</code> and <code>sum_cost()</code> to complete the <code>get_cost_allocations_and_list()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>get_cost_allocation_and_cm_list <span class="ot">&lt;-</span> <span class="cf">function</span>(.tab_cost, .tab_revenue) {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  lst_cost_ <span class="ot">&lt;-</span> <span class="fu">get_cost_allocation_list</span>(.tab_cost) <span class="co"># The Cost Allocation List</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  lst_cm_   <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co"># A new List for Contribution Margin</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  lst_cm_[[<span class="st">"revenues"</span>]] <span class="ot">&lt;-</span> <span class="fu">filter_revenue_input</span>(.tab_revenue) <span class="co"># Revenues</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  lst_cm_[[<span class="st">"var_cost"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE    </span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  lst_cm_[[<span class="st">"cm1"</span>]]      <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE    </span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  lst_cm_[[<span class="st">"fix_cost"</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE    </span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  lst_cm_[[<span class="st">"cm2"</span>]]      <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># YOUR CODE HERE    </span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(lst_cost_, lst_cm_)) <span class="co"># Return the combined list</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
</section>
<section id="task-4d-display-contribution-margin-table" class="level2">
<h2 class="anchored" data-anchor-id="task-4d-display-contribution-margin-table">Task 4D: Display Contribution Margin Table</h2>
<p>Remember Task 3C.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>get_contribution_margin_skeleton <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>sign, <span class="sc">~</span>var,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">" "</span>, <span class="st">"Revenue"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"-"</span>, <span class="st">"Variable Cost"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"="</span>, <span class="st">"Contribution Margin 1"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"-"</span>, <span class="st">"Product Fix Cost"</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"="</span>, <span class="st">"Contribution Margin 2"</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>make_cm_table <span class="ot">&lt;-</span> <span class="cf">function</span>(.tab_cost, .tab_revenue) {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># YOUR CODE HERE</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format_table</span>(<span class="fu">make_cm_table</span>(tab_cost, tab_revenue))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="brbwewvpaj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#brbwewvpaj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#brbwewvpaj thead, #brbwewvpaj tbody, #brbwewvpaj tfoot, #brbwewvpaj tr, #brbwewvpaj td, #brbwewvpaj th {
  border-style: none;
}

#brbwewvpaj p {
  margin: 0;
  padding: 0;
}

#brbwewvpaj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#brbwewvpaj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#brbwewvpaj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#brbwewvpaj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#brbwewvpaj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#brbwewvpaj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#brbwewvpaj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#brbwewvpaj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#brbwewvpaj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#brbwewvpaj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#brbwewvpaj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#brbwewvpaj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#brbwewvpaj .gt_spanner_row {
  border-bottom-style: hidden;
}

#brbwewvpaj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#brbwewvpaj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#brbwewvpaj .gt_from_md > :first-child {
  margin-top: 0;
}

#brbwewvpaj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#brbwewvpaj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#brbwewvpaj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#brbwewvpaj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#brbwewvpaj .gt_row_group_first td {
  border-top-width: 2px;
}

#brbwewvpaj .gt_row_group_first th {
  border-top-width: 2px;
}

#brbwewvpaj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#brbwewvpaj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#brbwewvpaj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#brbwewvpaj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#brbwewvpaj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#brbwewvpaj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#brbwewvpaj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#brbwewvpaj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#brbwewvpaj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#brbwewvpaj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#brbwewvpaj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#brbwewvpaj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#brbwewvpaj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#brbwewvpaj .gt_left {
  text-align: left;
}

#brbwewvpaj .gt_center {
  text-align: center;
}

#brbwewvpaj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#brbwewvpaj .gt_font_normal {
  font-weight: normal;
}

#brbwewvpaj .gt_font_bold {
  font-weight: bold;
}

#brbwewvpaj .gt_font_italic {
  font-style: italic;
}

#brbwewvpaj .gt_super {
  font-size: 65%;
}

#brbwewvpaj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#brbwewvpaj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#brbwewvpaj .gt_indent_1 {
  text-indent: 5px;
}

#brbwewvpaj .gt_indent_2 {
  text-indent: 10px;
}

#brbwewvpaj .gt_indent_3 {
  text-indent: 15px;
}

#brbwewvpaj .gt_indent_4 {
  text-indent: 20px;
}

#brbwewvpaj .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="sign">sign</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="var">var</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Total">Total</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Elite">Elite</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Premium">Premium</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sign" class="gt_row gt_left"> </td>
<td headers="var" class="gt_row gt_left">Revenue</td>
<td headers="Total" class="gt_row gt_right">475,000</td>
<td headers="Elite" class="gt_row gt_right">175,000</td>
<td headers="Premium" class="gt_row gt_right">300,000</td></tr>
    <tr><td headers="sign" class="gt_row gt_left">-</td>
<td headers="var" class="gt_row gt_left">Variable Cost</td>
<td headers="Total" class="gt_row gt_right">190,000</td>
<td headers="Elite" class="gt_row gt_right">70,000</td>
<td headers="Premium" class="gt_row gt_right">120,000</td></tr>
    <tr><td headers="sign" class="gt_row gt_left" style="font-weight: bold;">=</td>
<td headers="var" class="gt_row gt_left" style="font-weight: bold;">Contribution Margin 1</td>
<td headers="Total" class="gt_row gt_right" style="font-weight: bold;">285,000</td>
<td headers="Elite" class="gt_row gt_right" style="font-weight: bold;">105,000</td>
<td headers="Premium" class="gt_row gt_right" style="font-weight: bold;">180,000</td></tr>
    <tr><td headers="sign" class="gt_row gt_left">-</td>
<td headers="var" class="gt_row gt_left">Product Fix Cost</td>
<td headers="Total" class="gt_row gt_right">284,500</td>
<td headers="Elite" class="gt_row gt_right">114,600</td>
<td headers="Premium" class="gt_row gt_right">169,900</td></tr>
    <tr><td headers="sign" class="gt_row gt_left" style="font-weight: bold;">=</td>
<td headers="var" class="gt_row gt_left" style="font-weight: bold;">Contribution Margin 2</td>
<td headers="Total" class="gt_row gt_right" style="font-weight: bold;">500</td>
<td headers="Elite" class="gt_row gt_right" style="font-weight: bold; color: #FF0000;">(9,600)</td>
<td headers="Premium" class="gt_row gt_right" style="font-weight: bold;">10,100</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
<section id="monte-carlo-analysis" class="level1">
<h1>Monte Carlo Analysis</h1>
<p><strong>Introduction:</strong></p>
<p>Monte Carlo Analysis is a powerful statistical technique that allows you to account for uncertainty in your decision-making processes. It allows you to model possible outcomes by randomizing specific inputs according to predefined distributions. This approach is named after the city of Monte Carlo, known for its casinos, suggesting the element of chance or randomness.</p>
<p>In our context, we’ll be performing a Monte Carlo Analysis to simulate the effects of various inputs on our outcome variable: the contribution margin. This is a critical tool in finance and business strategy, allowing for a deeper understanding of potential variability in key metrics.</p>
<p><strong>Description:</strong></p>
<ol type="1">
<li><p><strong>Randomizing Input</strong>:</p>
<ul>
<li><p>The <strong><code>randomize_input</code></strong> function allows us to randomize a given input based on either a normal or uniform distribution. The randomness is controlled by the seed, ensuring reproducibility.</p>
<ul>
<li><p><strong><code>.distr</code></strong>: The distribution type. Can be either “normal” or “uniform”.</p></li>
<li><p><strong><code>.mean</code></strong>: The central tendency of your distribution.</p></li>
<li><p><strong><code>.bound</code></strong>: For the normal distribution, it’s the standard deviation. For the uniform distribution, it’s the range around the mean.</p></li>
<li><p><strong><code>.seed</code></strong>: Seed for reproducibility.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Randomizing Input Table</strong>:</p>
<ul>
<li><p>The <strong><code>randomize_input_table</code></strong> function is an extension of the <strong><code>randomize_input</code></strong> function but applies the randomness over an entire table.</p>
<ul>
<li><p><strong><code>.tab</code></strong>: The table you want to randomize.</p></li>
<li><p><strong><code>.seed</code></strong>: Seed for reproducibility.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Test Random Functions</strong>:</p>
<ul>
<li>In the given scripts, there’s a small test showing how to randomize inputs for both single values and entire tables.</li>
</ul></li>
<li><p><strong>Contribution Margin Table</strong>:</p>
<ul>
<li>The <strong><code>make_cm_table</code></strong> function computes the contribution margin table by randomizing the cost and revenue tables.</li>
</ul></li>
<li><p><strong>Running Monte Carlo Simulation</strong>:</p>
<ul>
<li><p>Monte Carlo Simulations involve repeating the randomization process multiple times and observing the resulting outcomes.</p>
<ul>
<li><p>We use the <strong><code>purrr::map</code></strong> function to run the <strong><code>get_cost_allocation_and_cm</code></strong> function multiple times.</p></li>
<li><p>The simulation is repeated 100 times, with a different seed each time to ensure variability.</p></li>
<li><p>We use the <strong><code>tictoc</code></strong> package to measure how long the entire simulation process takes. This can be useful to understand the computational complexity.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Parallel Processing</strong>:</p>
<ul>
<li><p>To speed up the Monte Carlo simulations, we leverage the power of parallel processing. This means that multiple computations run simultaneously.</p>
<ul>
<li><p><strong><code>future::availableCores()</code></strong>: Determines the number of available processing cores.</p></li>
<li><p><strong><code>furrr::future_map</code></strong>: A function from the <strong><code>furrr</code></strong> package that allows for parallel processing. This drastically reduces the time needed for simulations when you have multiple cores available.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Visualization</strong>:</p>
<ul>
<li><p>Once the simulation is done, it’s time to visualize the outcomes.</p>
<ul>
<li>The <strong><code>display_histogram</code></strong> function is used to provide a histogram of the contribution margin’s possible values. This gives a visual representation of the most likely values, the variability, and the possible range of the contribution margin.</li>
</ul></li>
</ul></li>
</ol>
<p><strong>Key Takeaways:</strong></p>
<ul>
<li><p>Monte Carlo Analysis helps in understanding the potential range and variability of financial outcomes.</p></li>
<li><p>It emphasizes not only focusing on the most likely outcome but also considering a range of possible outcomes.</p></li>
<li><p>Parallel processing can speed up the process significantly, especially when dealing with a large number of simulations.</p></li>
<li><p>Visualization tools, such as histograms, offer a succinct way to interpret the results of Monte Carlo Analysis.</p></li>
</ul>
<p>Remember, while Monte Carlo Analysis provides a range of outcomes, it doesn’t predict the future. Instead, it offers a probabilistic view of potential outcomes based on the variability of the inputs. It’s an essential tool for risk analysis, helping businesses prepare for a range of scenarios.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>randomize_input <span class="ot">&lt;-</span> <span class="cf">function</span>(.distr, .mean, .bound, .seed) {</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(.seed)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (.distr <span class="sc">==</span> <span class="st">"normal"</span>) {</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">1</span>, .mean, .bound)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (.distr <span class="sc">==</span> <span class="st">"uniform"</span>) {</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">1</span>, .mean <span class="sc">-</span> .bound, .mean <span class="sc">+</span> .bound)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Wrong Distribution Specified"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>randomize_input_table <span class="ot">&lt;-</span> <span class="cf">function</span>(.tab, .seed) {</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  .tab <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">amount =</span> purrr<span class="sc">::</span><span class="fu">pmap_dbl</span>(</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">.l =</span> <span class="fu">list</span>(distr, amount, range_std), </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">randomize_input</span>(..<span class="dv">1</span>, ..<span class="dv">2</span>, ..<span class="dv">3</span>, .seed)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        )) <span class="sc">%&gt;%</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">amount =</span> purrr<span class="sc">::</span><span class="fu">set_names</span>(amount, product))</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="fu">randomize_input</span>(tab_cost<span class="sc">$</span>distr[<span class="dv">1</span>], tab_cost<span class="sc">$</span>amount[<span class="dv">1</span>], tab_cost<span class="sc">$</span>range_std[<span class="dv">1</span>], <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 26867.73</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">randomize_input_table</span>(<span class="at">.tab =</span> tab_revenue, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 6
  product units price  amount distr  range_std
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
1 Elite     500   350 152577. normal     25000
2 Premium   500   600 273093. normal     30000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_cm_table</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">.tab_cost =</span> <span class="fu">randomize_input_table</span>(tab_cost, <span class="dv">2</span>), </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.tab_revenue =</span> <span class="fu">randomize_input_table</span>(tab_revenue, <span class="dv">2</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span>  <span class="fu">format_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ffhqqlirka" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ffhqqlirka table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ffhqqlirka thead, #ffhqqlirka tbody, #ffhqqlirka tfoot, #ffhqqlirka tr, #ffhqqlirka td, #ffhqqlirka th {
  border-style: none;
}

#ffhqqlirka p {
  margin: 0;
  padding: 0;
}

#ffhqqlirka .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ffhqqlirka .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ffhqqlirka .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ffhqqlirka .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ffhqqlirka .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ffhqqlirka .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ffhqqlirka .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ffhqqlirka .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ffhqqlirka .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ffhqqlirka .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ffhqqlirka .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ffhqqlirka .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ffhqqlirka .gt_spanner_row {
  border-bottom-style: hidden;
}

#ffhqqlirka .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ffhqqlirka .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ffhqqlirka .gt_from_md > :first-child {
  margin-top: 0;
}

#ffhqqlirka .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ffhqqlirka .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ffhqqlirka .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ffhqqlirka .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ffhqqlirka .gt_row_group_first td {
  border-top-width: 2px;
}

#ffhqqlirka .gt_row_group_first th {
  border-top-width: 2px;
}

#ffhqqlirka .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ffhqqlirka .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ffhqqlirka .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ffhqqlirka .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ffhqqlirka .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ffhqqlirka .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ffhqqlirka .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ffhqqlirka .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ffhqqlirka .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ffhqqlirka .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ffhqqlirka .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ffhqqlirka .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ffhqqlirka .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ffhqqlirka .gt_left {
  text-align: left;
}

#ffhqqlirka .gt_center {
  text-align: center;
}

#ffhqqlirka .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ffhqqlirka .gt_font_normal {
  font-weight: normal;
}

#ffhqqlirka .gt_font_bold {
  font-weight: bold;
}

#ffhqqlirka .gt_font_italic {
  font-style: italic;
}

#ffhqqlirka .gt_super {
  font-size: 65%;
}

#ffhqqlirka .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ffhqqlirka .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ffhqqlirka .gt_indent_1 {
  text-indent: 5px;
}

#ffhqqlirka .gt_indent_2 {
  text-indent: 10px;
}

#ffhqqlirka .gt_indent_3 {
  text-indent: 15px;
}

#ffhqqlirka .gt_indent_4 {
  text-indent: 20px;
}

#ffhqqlirka .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="sign">sign</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="var">var</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Total">Total</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Elite">Elite</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Premium">Premium</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sign" class="gt_row gt_left"> </td>
<td headers="var" class="gt_row gt_left">Revenue</td>
<td headers="Total" class="gt_row gt_right">425,670</td>
<td headers="Elite" class="gt_row gt_right">152,577</td>
<td headers="Premium" class="gt_row gt_right">273,093</td></tr>
    <tr><td headers="sign" class="gt_row gt_left">-</td>
<td headers="var" class="gt_row gt_left">Variable Cost</td>
<td headers="Total" class="gt_row gt_right">175,201</td>
<td headers="Elite" class="gt_row gt_right">63,273</td>
<td headers="Premium" class="gt_row gt_right">111,928</td></tr>
    <tr><td headers="sign" class="gt_row gt_left" style="font-weight: bold;">=</td>
<td headers="var" class="gt_row gt_left" style="font-weight: bold;">Contribution Margin 1</td>
<td headers="Total" class="gt_row gt_right" style="font-weight: bold;">250,469</td>
<td headers="Elite" class="gt_row gt_right" style="font-weight: bold;">89,304</td>
<td headers="Premium" class="gt_row gt_right" style="font-weight: bold;">161,165</td></tr>
    <tr><td headers="sign" class="gt_row gt_left">-</td>
<td headers="var" class="gt_row gt_left">Product Fix Cost</td>
<td headers="Total" class="gt_row gt_right">258,503</td>
<td headers="Elite" class="gt_row gt_right">101,632</td>
<td headers="Premium" class="gt_row gt_right">156,871</td></tr>
    <tr><td headers="sign" class="gt_row gt_left" style="font-weight: bold;">=</td>
<td headers="var" class="gt_row gt_left" style="font-weight: bold;">Contribution Margin 2</td>
<td headers="Total" class="gt_row gt_right" style="font-weight: bold; color: #FF0000;">(8,034)</td>
<td headers="Elite" class="gt_row gt_right" style="font-weight: bold; color: #FF0000;">(12,328)</td>
<td headers="Premium" class="gt_row gt_right" style="font-weight: bold;">4,294</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>lst_monte_carlo <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">get_cost_allocation_and_cm_list</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.tab_cost =</span> <span class="fu">randomize_input_table</span>(tab_cost, .x),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.tab_revenue =</span> <span class="fu">randomize_input_table</span>(tab_revenue, .x)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">.progress =</span> <span class="cn">TRUE</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> =============================&gt;-   98% |  ETA:  0s</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.86 sec elapsed</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">20</span>, future<span class="sc">::</span><span class="fu">availableCores</span>() <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(<span class="st">"multisession"</span>, <span class="at">workers =</span> cores)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>lst_monte_carlo <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">get_cost_allocation_and_cm_list</span>(</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.tab_cost =</span> <span class="fu">randomize_input_table</span>(tab_cost, .x),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.tab_revenue =</span> <span class="fu">randomize_input_table</span>(tab_revenue, .x)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">.progress =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>future<span class="sc">::</span><span class="fu">plan</span>(<span class="st">"default"</span>)</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>28.09 sec elapsed</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>lst_monte_carlo_transposed <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">transpose</span>(lst_monte_carlo)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">display_histogram</span>(<span class="at">.lst =</span> lst_monte_carlo_transposed<span class="sc">$</span>cm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><span class="faux-block">© Matthias Uckert (2023)</span></div>   
    <div class="nav-footer-center"><span class="faux-block"><a href="https://github.com/MatthiasUckert/RpMMA24/">View source on GitHub</a></span></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>